<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>University Management System</title>


  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <!-- Bootstrap Table plugin -->
  <link href="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.css" rel="stylesheet">


  <!-- Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
  <link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" rel="stylesheet"
    integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

</head>

<body>

  <div id="loading-placeholder">
  </div>

  <nav id="nav-placeholder">
  </nav>


  <div class="container">

    <h3 class="h3 mt-4 mb-5">
      Student detail<br />
      <small class="h4 text-muted">Detail of a student enrolled at the university </small>
    </h3>

    <h4 class="h4">Single-row table</h4>
    <div class="table-responsive-x">
      <table id="table"></table>
    </div>



    <div class="row mb-3 gx-5">

      <div class="col-9">

        <form>
          <h4 class="h4 mt-5">Detail</h4>

          <div class="row gy-2">

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="idInput" class="form-label">ID</label>
              <input id="idInput" type="text" class="form-control" value="0" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="lastNameInput" class="form-label">Last name</label>
              <input id="lastNameInput" type="text" class="form-control" value="Washington" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="firstNameInput" class="form-label">First name</label>
              <input id="firstNameInput" type="text" class="form-control" value="Georges" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="genderInput" class="form-label">Gender</label>
              <input id="genderInput" type="text" class="form-control" value="GENDER_MALE" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="emailInput" class="form-label">E-mail</label>
              <input id="emailInput" type="text" class="form-control" value="georges.washington@gmail.com"
                disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="phoneInput" class="form-label">Phone</label>
              <input id="phoneInput" type="text" class="form-control" value="0694656761" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="levelInput" class="form-label">Level</label>
              <input id="levelInput" type="text" class="form-control" value="2" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="warningsInput" class="form-label">Warnings</label>
              <input id="warningsInput" type="text" class="form-control" value="0" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="accountBalanceInput" class="form-label">Account balance</label>
              <input id="accountBalanceInput" type="text" class="form-control" value="0.0" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="creditsObtainedInput" class="form-label">Credits obtained</label>
              <input id="creditsObtainedInput" type="text" class="form-control" value="0" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="totalTuitionInput" class="form-label">Total tuition</label>
              <input id="totalTuitionInput" type="text" class="form-control" value="0.0" disabled></input>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
              <label for="lastDiplomaObtainedInput" class="form-label">Last diploma obtained</label>
              <input id="lastDiplomaObtainedInput" type="text" class="form-control" value="" disabled></input>
            </div>

        </form>
      </div>
    </div>



    <div class="col-3">

      <h4 class="h4 mt-5">Actions</h4>

      <label class="form-label">Contact</label><br />
      <div class="row mx-0">
        <button id="emailButton" type="button" class="btn btn-primary text-truncate col-xxl-6 col-12">
          <i class="bi bi-envelope"></i>
          <span class="d-none d-md-inline ms-2">Send email</span></button>
        <button id="textButton" type="button" class="btn btn-primary text-truncate col-xxl-6 col-12">
          <i class="bi bi-chat-left-text"></i>
          <span class="d-none d-md-inline ms-2">Send text</span>
        </button>
      </div>

      <label class="form-label mt-2">Level</label><br />
      <div class="row mx-0">
        <button id="promoteButton" class="btn btn-secondary text-truncate col-xxl-6 col-12"><i
            class="bi bi-chevron-double-up"></i>
          <span class="d-none d-md-inline ms-2">Promote</span></button>
        <button id="demoteButton" type="button" class="btn btn-secondary text-truncate col-xxl-6 col-12"><i
            class="bi bi-chevron-double-down"></i>
          <span class="d-none d-md-inline ms-2">Demote</span></button>
      </div>

      <label class="form-label mt-2">Sanction</label><br />
      <div class="row mx-0">
        <button id="warningButton" type="button" class="btn btn-danger text-truncate col-xxl-6 col-12"><i
            class="bi bi-exclamation-diamond"></i>
          <span class="d-none d-md-inline ms-2">Give warning</span></button>
        <button id="kickoutButton" type="button" class="btn btn-danger text-truncate col-xxl-6 col-12"><i
            class="bi bi-x-octagon"></i>
          <span class="d-none d-md-inline ms-2">Kick out</span></button>
      </div>

      <label class="form-label mt-2">Reward</label><br />
      <div class="row mx-0">
        <button id="creditsButton" type="button" class="btn btn-success text-truncate col-xxl-6 col-12"><i
            class="bi bi-award"></i>
          <span class="d-none d-md-inline ms-2">Give credits</span></button>
        <button id="diplomaButton" type="button" class="btn btn-success text-truncate col-xxl-6 col-12"><i
            class="bi bi-mortarboard"></i>
          <span class="d-none d-md-inline ms-2">Give diploma</span></button>
      </div>

      <label class="form-label mt-2">Misc.</label><br />
      <div class="row mx-0">
        <button id="editEntryButton" type="button" class="btn btn-dark text-truncate col-xxl-6 col-12"><i
            class="bi bi-pencil-square"></i>
          <span class="d-none d-md-inline ms-2">Edit entry</span></button>
        <button id="saveEntryButton" type="button" class="btn btn-dark text-truncate col-xxl-6 col-12"
          data-bs-toggle="modal" data-bs-target="#recapModal" aria-expanded="false" aria-controls="recapModal"><i
            class="bi bi-save2"></i>
          <span class="d-none d-md-inline ms-2">Save entry</span></button>
        <!-- Modal -->
        <div class="modal fade" id="recapModal" tabindex="-1" aria-labelledby="recapModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="recapModalLabel">Change confirmation prompt
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="mb-1">Here is a recap of the edit you are about to perform:</div>
                <div class="bg-light px-3 py-2 form-control">
                  Target name: <strong>SMITHINGSTON Timothy</strong><br />
                  Target Uni-ID&trade;: <strong>2022-01-15061995</strong><br />
                  Feature: <strong>PROMOTE</strong><br />
                  Attribute: <strong>LEVEL</strong><br />
                  From (before): <strong>1</strong><br />
                  To (after): <strong>2</strong> <br />
                  Change by: <strong>SOMEONE Else (Admin)</strong><br />
                  Date and time: <strong>1/26/2022, 11:29:21 PM</strong>
                </div>
                <div class="mt-3">Please provide a reason for this change:</div>
                <textarea class="form-control mt-1 mb-3" id="formId" aria-describedby="formIdHelp" rows='2'
                  data-min-rows='2'>Successfully completed their year.</textarea>
                You will not be able to cancel afterward, and you might not be able to revert the changes. Are you
                sure you want to perform this edit and save this change?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <label class="form-label mt-2">TBD</label><br />
      <div class="row mx-0">
        <button type="button" class="btn btn-info text-truncate col-xxl-6 col-12"><i class="bi bi-patch-question"></i>
          <span class="d-none d-md-inline ms-2">TBD 1</span></button>
        <button type="button" class="btn btn-info text-truncate col-xxl-6 col-12"><i class="bi bi-patch-question"></i>
          <span class="d-none d-md-inline ms-2">TBD 2</span></button>
      </div>

    </div>


  </div>





  <!-- JQuery script -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <!-- Bootstrap 5 script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>

  <!-- Bootstrap Table plugin script -->
  <script src="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.js"></script>

  <!-- Local scripts -->
  <script type="text/javascript" src="js/simpleTableScript.js"></script>
  <script type="text/javascript" src="js/navbarScript.js"></script>
  <script type="text/javascript" src="js/loadingScript.js"></script>
  <script type="text/javascript" src="js/formattersScript.js"></script>





  <script>

    console.log(new Date().toLocaleString())

    // DOM elements
    var $table = $('#table')

    // Columns
    var modelColumns = JSON.parse(localStorage["modelColumns"])

    // Eager fetch from server
    var url = "http://localhost:8080/students/get/" + localStorage["detailId"];

    buildSimpleTable($table, url, modelColumns);
    $table.bootstrapTable('refreshOptions',
      {
        responseHandler: function (res) { return [res.data.student] }
      }
    )


    document.getElementById("idInput").value = sourceData[0].id;
    document.getElementById("lastNameInput").value = sourceData[0].lastName;
    document.getElementById("firstNameInput").value = sourceData[0].firstName;
    document.getElementById("genderInput").value = sourceData[0].gender;
    document.getElementById("emailInput").value = sourceData[0].email;
    document.getElementById("phoneInput").value = sourceData[0].phone;
    document.getElementById("levelInput").value = sourceData[0].level;
    document.getElementById("warningsInput").value = sourceData[0].warnings;
    document.getElementById("accountBalanceInput").value = sourceData[0].accountBalance;
    document.getElementById("creditsObtainedInput").value = sourceData[0].creditsObtained;
    document.getElementById("totalTuitionInput").value = sourceData[0].totalTuition;
    document.getElementById("lastDiplomaObtainedInput").value = sourceData[0].lastDiplomaObtained;







    const promoteButton = document.getElementById('promoteButton');


    // PUT - ...FORM...
    promoteButton.addEventListener('click', async _ => {
      try {
        const response = await fetch('http://localhost:8080/students/update/' + document.getElementById("idInput").value, {
          method: 'put',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
          },
          body: new URLSearchParams({
            "level": document.getElementById("levelInput").value - 1
          })
        });
        console.log('Completed!', response);
      } catch (err) {
        console.error(`Error: ${err}`);
      }
    });


  </script>

</body>

</html>